{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nconst API_KEY = \"52838885-6d116f44af4c58ac8463c8402\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n\nexport async function getImagesByQuery(query,page) {\n    const { data } = await axios(BASE_URL, { \n        params:  {\n        key: API_KEY,\n        q: query,\n        mage_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: 15,\n        page,\n}});\n    return data;\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryContainer = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\nconst loader = document.querySelector(\".loader\");\n\nlet lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 300,\n});\n\nexport function createGallery(images) {\n    const markup = images\n    .map(\n        (item) => `\n        <li class=\"gallery-item\">\n        <a href=\"${item.largeImageURL}\">\n            <img src=\"${item.webformatURL}\" alt=\"${item.tags}\"/>\n        </a>\n        <ul class=\"card\">\n            <li class=\"card-item\"><b>Likes:</b> ${item.likes}</li>\n            <li class=\"card-item\"><b>Views:</b> ${item.views}</li>\n            <li class=\"card-item\"><b>Comments:</b> ${item.comments}</li>\n            <li class=\"card-item\"><b>Downloads:</b> ${item.downloads}</li>\n        </ul>\n        </li>`\n    )\n    .join(\"\");\n\n  galleryContainer.insertAdjacentHTML(\"beforeend\", markup);\n\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  galleryContainer.innerHTML = \"\";\n  lightbox.refresh();\n}\n\nexport function showLoader() {\n  loader.classList.remove(\"is-hidden\");\n}\nexport function hideLoader() {\n  loader.classList.add(\"is-hidden\");\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove(\"is-hidden\");\n}\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add(\"is-hidden\");\n}\n\nexport const loadMoreButton = loadMoreBtn;\n\nexport const galleryEl = galleryContainer;","import { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton, loadMoreButton, galleryEl, } from \"./js/render-functions.js\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst form = document.querySelector(\".form\");\nconst input = form.querySelector(\"input[name='search-text']\");\n\nlet currentQuery = \"\";\nlet currentPage = 1;\nconst PER_PAGE = 15;\nlet totalHits = 0;\nlet loadedHits = 0;\n\n\nform.addEventListener(\"submit\", onSearch);\nloadMoreButton.addEventListener(\"click\", onLoadMore);\n\nasync function onSearch(event) {\n  event.preventDefault();\n\n  const query = input.value.trim();\n\n  if (!query) {\n    iziToast.warning({\n      message: \"Please enter a search term!\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  if (query !== currentQuery) {\n    currentQuery = query;\n    currentPage = 1;\n    loadedHits = 0;\n    totalHits = 0;\n  }\n\n  clearGallery();\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    totalHits = data.totalHits || 0;\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.error({\n        message:\n          \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\"\n      });\n      return;\n    }\n\n    createGallery(data.hits);\n    input.value = \"\";\n\n    loadedHits += data.hits.length;\n\n      if (loadedHits < totalHits) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message: \"Something went wrong. Please try again later.\",\n      position: \"topRight\"\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore() {\n  loadMoreButton.disabled = true;\n  showLoader();\n\n  currentPage += 1;\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    createGallery(data.hits);\n\n    loadedHits += data.hits.length;\n\n    const firstCard = galleryEl.querySelector(\".gallery-item\");\n    if (firstCard) {\n      const { height } = firstCard.getBoundingClientRect();\n      window.scrollBy({\n        top: height * 2,\n        behavior: \"smooth\",\n      });\n    }\n\n    if (loadedHits >= (data.totalHits || totalHits)) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    iziToast.error({\n      message: \"Something went wrong while loading more images.\",\n      position: \"topRight\"\n    });\n  } finally {\n    hideLoader();\n    loadMoreButton.disabled = false;\n  }\n}"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","data","axios","galleryContainer","loadMoreBtn","loader","lightbox","SimpleLightbox","createGallery","images","markup","item","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","loadMoreButton","galleryEl","form","input","currentQuery","currentPage","totalHits","loadedHits","onSearch","onLoadMore","event","iziToast","firstCard","height"],"mappings":"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"}